matrix:
  include:
  - os: linux
    jdk: oraclejdk8
    sudo: false
    addons:
      apt:
        sources:
        - ubuntu-toolchain-r-test
        packages:
        - lib32stdc++6
        - libstdc++6
        - fonts-droid
    before_script:
    - wget -q https://dl.google.com/android/repository/sdk-tools-linux-3859397.zip
    - mkdir android-sdk
    - unzip -qq sdk-tools-linux-3859397.zip -d android-sdk
    - export ANDROID_HOME=`pwd`/android-sdk
    - export PATH=`pwd`/android-sdk/tools/bin:$PATH
    - mkdir -p /home/travis/.android
    - echo 'count=0' > /home/travis/.android/repositories.cfg
    - echo y | sdkmanager "tools"
    - echo y | sdkmanager "platform-tools"
    - echo y | sdkmanager "build-tools;25.0.3"
    - echo y | sdkmanager "platforms;android-25"
    - echo y | sdkmanager "extras;android;m2repository"
    - echo y | sdkmanager "extras;google;m2repository"
    - echo y | sdkmanager "patcher;v4"
    - sdkmanager --list
    - wget -q http://services.gradle.org/distributions/gradle-3.5-bin.zip
    - unzip -qq gradle-3.5-bin.zip
    - export GRADLE_HOME=$PWD/gradle-3.5
    - export PATH=$GRADLE_HOME/bin:$PATH
    - gradle -v
    - git clone https://github.com/flutter/flutter.git
    - "./flutter/bin/flutter channel beta"
    - "./flutter/bin/flutter doctor"
    script:
    - "./flutter/bin/flutter test"
    - "./flutter/bin/flutter -v build apk"
  - os: osx
    language: generic
    osx_image: xcode9.2
    before_script:
    - pip2 install six
    - brew update
    - brew install libimobiledevice
    - brew install ideviceinstaller
    - brew install ios-deploy
    - git clone https://github.com/flutter/flutter.git
    - "./flutter/bin/flutter channel beta"
    - "./flutter/bin/flutter doctor"
    script:
    - "./flutter/bin/flutter test"
    - "./flutter/bin/flutter -v build ios --no-codesign"
cache:
  directories:
  - "$HOME/.pub-cache"
deploy:
  provider: releases
  api_key:
    secure: H0TJKWNSPrFdilsZahcv9E/88xzF/dprUNk1rvx/H4qSrtnFL0r4AEI2OiLNG0Q2aVs3ISiV6YEVSAf0rPZ9kXcBDhC7Jfswfyh6HnB0lwVjTNYXvQzAtQBdtdG2q3fISkAacxuhBofgvXWvbh7SxpXp55ePH2+CDMh2L1RlHFXeEDcQDZUOiYy0svE/z156cpHtBGgp72hYW+hMmzEvYNPq1itXNF1ICojsFtUEm2ddR78iSAKNGtORYI2ZQvB8qSZdfx8AlWvuCg/UU0tBNpRVXV8HUrcBooggk3mCK6K2FX7Wft32FbwTBAD76Oh7wURVkOJ7Qx/6isXalHxB9dy4ESUzR7TuTHUXk16VYS9lPC17rXrPkBJthVRzFXCqCVab/jZ7qqsjDnSmyl6ujevHJZaVTMjmENgmoXCTyteh1SLiTt/bvxDDIDtX075GwZ+7YTeAP2sAeIczk+5Ze7/3BQJBQubvTpjj6yw/aNk+tAPOL0sNYnC+3Fr3bhjFdHZGQIGH+slXms463kfHZvGAb/Qb8l9ixGthlctg4vJc8v5Ql9hkio/sieSAHrKiUxS+Qrcl9rAg2qBzv33wFv9EMLqV/Izxw+I27LaZDlwkCJ2/t1LgaT2/6i5sqQLPnBjwp6ZeGQSlZH1O6jM8d0s09hn1DL/LRczo2NcydgA=
  file: 
  - "/User/travis/HYY-yu/Chic/build/ios/iphoneos/Runner.app"
  - "/User/travis/HYY-yu/Chic/build/app/outputs/apk/release/app-release.apk"
  on:
    repo: HYY-yu/Chic
